---
import ThemeToggle from './ThemeToggle.astro';
---

<nav class="nav" id="nav">
  <div class="nav-inner">
    <a href="#" class="nav-logo">LP</a>

    <div class="nav-links" id="nav-links">
      <a href="#about">About</a>
      <a href="#experience">Experience</a>
      <a href="#media">Media</a>
      <a href="#projects">Projects</a>
    </div>

    <div class="nav-actions">
      <ThemeToggle />
      <button class="nav-hamburger" id="nav-hamburger" aria-label="Toggle menu" aria-expanded="false">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
  </div>
</nav>

<!-- Mobile overlay -->
<div class="nav-overlay" id="nav-overlay">
  <div class="nav-overlay-links">
    <a href="#about">About</a>
    <a href="#experience">Experience</a>
    <a href="#media">Media</a>
    <a href="#projects">Projects</a>
  </div>
</div>

<script is:inline>
  (function() {
    const hamburger = document.getElementById('nav-hamburger');
    const overlay = document.getElementById('nav-overlay');
    const nav = document.getElementById('nav');
    let lastScroll = 0;

    if (hamburger && overlay) {
      hamburger.addEventListener('click', () => {
        const isOpen = overlay.classList.toggle('open');
        hamburger.classList.toggle('open');
        hamburger.setAttribute('aria-expanded', String(isOpen));
        document.body.style.overflow = isOpen ? 'hidden' : '';
      });

      overlay.querySelectorAll('a').forEach(link => {
        link.addEventListener('click', () => {
          overlay.classList.remove('open');
          hamburger.classList.remove('open');
          hamburger.setAttribute('aria-expanded', 'false');
          document.body.style.overflow = '';
        });
      });
    }

    // Hide nav on scroll down, show on scroll up
    if (nav) {
      window.addEventListener('scroll', () => {
        const current = window.scrollY;
        if (current > 100) {
          nav.classList.toggle('nav-hidden', current > lastScroll);
        } else {
          nav.classList.remove('nav-hidden');
        }
        nav.classList.toggle('nav-scrolled', current > 50);
        lastScroll = current;
      }, { passive: true });
    }
  })();
</script>

<style>
  .nav {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 100;
    padding: 1rem 1.5rem;
    transition: transform 0.3s ease, background-color 0.3s ease;
  }

  .nav-hidden {
    transform: translateY(-100%);
  }

  .nav-scrolled {
    background-color: rgba(10, 10, 15, 0.8);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border-bottom: 1px solid var(--color-border);
  }

  :global([data-theme="light"]) .nav-scrolled,
  :global(:root:not([data-theme="dark"])) .nav-scrolled {
    background-color: rgba(250, 249, 247, 0.8);
  }

  @media (prefers-color-scheme: light) {
    :global(:root:not([data-theme="dark"])) .nav-scrolled {
      background-color: rgba(250, 249, 247, 0.8);
    }
  }

  .nav-inner {
    max-width: 1200px;
    margin: 0 auto;
    display: flex;
    align-items: center;
    justify-content: space-between;
  }

  .nav-logo {
    font-family: var(--font-display);
    font-size: 1.5rem;
    font-style: italic;
    color: var(--color-text-primary);
    text-decoration: none;
    transition: color 0.2s;
  }

  .nav-logo:hover {
    color: var(--color-accent);
  }

  .nav-links {
    display: none;
    gap: 2rem;
  }

  @media (min-width: 768px) {
    .nav-links {
      display: flex;
    }
  }

  .nav-links a {
    font-size: var(--text-small);
    font-weight: 500;
    color: var(--color-text-secondary);
    text-decoration: none;
    letter-spacing: 0.02em;
    transition: color 0.2s;
  }

  .nav-links a:hover {
    color: var(--color-text-primary);
  }

  .nav-actions {
    display: flex;
    align-items: center;
    gap: 0.75rem;
  }

  /* Hamburger */
  .nav-hamburger {
    display: flex;
    flex-direction: column;
    justify-content: center;
    gap: 5px;
    width: 36px;
    height: 36px;
    background: none;
    border: none;
    cursor: pointer;
    padding: 6px;
  }

  @media (min-width: 768px) {
    .nav-hamburger {
      display: none;
    }
  }

  .nav-hamburger span {
    display: block;
    width: 100%;
    height: 2px;
    background-color: var(--color-text-primary);
    transition: transform 0.3s ease, opacity 0.3s ease;
    transform-origin: center;
  }

  .nav-hamburger.open span:nth-child(1) {
    transform: translateY(7px) rotate(45deg);
  }
  .nav-hamburger.open span:nth-child(2) {
    opacity: 0;
  }
  .nav-hamburger.open span:nth-child(3) {
    transform: translateY(-7px) rotate(-45deg);
  }

  /* Mobile overlay */
  .nav-overlay {
    position: fixed;
    inset: 0;
    z-index: 99;
    background-color: var(--color-bg-primary);
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s ease;
  }

  .nav-overlay.open {
    opacity: 1;
    pointer-events: auto;
  }

  .nav-overlay-links {
    display: flex;
    flex-direction: column;
    gap: 2rem;
    text-align: center;
  }

  .nav-overlay-links a {
    font-family: var(--font-display);
    font-size: clamp(2rem, 6vw, 3rem);
    font-style: italic;
    color: var(--color-text-primary);
    text-decoration: none;
    transition: color 0.2s;
  }

  .nav-overlay-links a:hover {
    color: var(--color-accent);
  }
</style>
